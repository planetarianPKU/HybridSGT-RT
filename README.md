# HybridSGT-RT
# **Representation-Theorem Synthetic Seismogram Generator**

## **1. Overview**

This program computes synthetic velocity seismograms using the **displacement representation theorem (RP)** together with a **strain Green’s tensor (SGT) database** generated by **SPECFEM3D_Cartesian** (Komatitsch & Tromp, 1999).

Two types of SGT databases are used:

- **SSGTs** — Strain Green’s tensors from the *source side*
- **RSGTs** — Strain Green’s tensors from the *receiver side*

Synthetic waveforms are obtained by integrating traction–displacement terms over the **five boundary surfaces** of the computational domain (see *Wu et al., 2018*).

---

## **2. Directory Structure**

```
SGT_upload/
├── binfiles/
│   ├── MESH_IN/        # IN-MESH geometry & material binaries
│   └── MESH_OUT/       # OUT-MESH coordinate binaries
├── SSGT/
│   └── eventXXX/       # IN-side SGT MAT files
├── RSGT/
│   └── station/
│       └── dirX/       # OUT-side SGT MAT files
└── OUTPUT/
    └── station/        # Final synthetic seismograms

```


---

## **RSGT Setup Instructions**

Follow the steps below to prepare the receiver-side SGT database:

1. Create a folder named **RSGT** in the root directory.
2. Inside `RSGT`, create one subfolder for **each station name**.
3. In each station’s subfolder, extract the corresponding  
   **`dir1.zip`**, **`dir2.zip`**, **`dir3.zip`** files.

---


## **3. Code Structure**

The project contains three main MATLAB scripts/functions:

### **• GLL_main_program.m**
The main workflow that:
- Loops over events, stations, and source components  
- Loads required SGT datasets  
- Calls the RP and GLL integration modules  
- Generates and saves the final synthetic seismograms  

### **• prepare_data.m**
A preprocessing module that:
- Reads SGT MAT files (SSGT and RSGT)
- Extracts all required physical quantities  
- Reorders, aligns, and consolidates coordinates, materials, Jacobians, GLL weights, and SGT tensors  
- Outputs a standardized dataset for the RP and GLL stages  

### **• get_GLLintegral.m**
The numerical integration module that:
- Performs SEM-style GLL surface integration  
- Computes the traction–displacement integrals on all five boundary surfaces  
- Produces the final waveform components (xmin, xmax, ymin, ymax, bottom) and their sum  

These modules together implement the complete representation-theorem–based synthetic waveform generation workflow.


---


## **4. Output**

For each station and each force component, the program produces a `.mat` file containing:

- **`GLL_result.total_integral`** — the final synthetic velocity seismogram  
- Individual surface contributions:
  - **xmin**
  - **xmax**
  - **ymin**
  - **ymax**
  - **bottom (z)**

These correspond to the five RP boundary integrals.

---

## **5. Notes on Provided Data**

Due to upload size limitations, only the **RSGT databases for two stations** are included in this repository.

If additional stations or full datasets are required,  
**please contact the author.**

---

## **6. SGT Database Information**

The SGT database is extracted **directly from SPECFEM3D_Cartesian** (Komatitsch & Tromp, 1999), ensuring full numerical accuracy.

All SGTs, material properties, geometry, and GLL-related quantities are reorganized and stored in **MATLAB `.mat`** format for ease of use.

If you need additional datasets or customized processing, feel free to contact the author.

---

## **7. References**

- Komatitsch, D., & Tromp, J. (1999). Introduction to the spectral element method for three-dimensional seismic wave propagation. Geophysical Journal International, 139(3), 806–822. 
- Wu, W., Ni, S., Zhan, Z., & Wei, S. (2018). An SEM-DSM three-dimensional hybrid method for modelling teleseismic waves with complicated source-side structures. Geophysical Journal International, 215(1), 133–154. 
- Sun, J. (2025). SGT Dataset and MATLAB codes for Hybrid Simulation. Zenodo. https://doi.org/10.5281/zenodo.17624366.
- JingNan Sun, Yi Wang, Li Zhao, and RiSheng Chu. 2026: Regional‑Scale Full 3‑D Hybrid Waveform Forward Modeling. Earth and Planetary Physics. DOI: 10.26464/epp2026019
---



